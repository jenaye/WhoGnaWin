<?php

namespace AppBundle\Repository;

use AppBundle\Entity\Game;
use Doctrine\ORM\Query\Expr\Join;


/**
 * PlayerRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PlayerRepository extends \Doctrine\ORM\EntityRepository
{
    public function getPlayerByName($playerName)
{
    $queryBuilder = $this->createQueryBuilder('p');

    return $queryBuilder
        ->where($queryBuilder->expr()->like('p.name', ':name'))
        ->setParameter('name', '%'.$playerName.'%')
        ->getQuery()->getOneOrNullResult();
}

    public function getPlayerByGender($gender){
        $queryBuilder = $this->createQueryBuilder('p');

        return $queryBuilder
            ->where($queryBuilder->expr()->like('p.gender', ':sex'))
            ->setParameter('sex', '%'.$gender.'%')
            ->getQuery()->getResult();
    }

    public function getPlayerByNameAndTournament($playerName, $tournamentName)
    {
    	$parameters = [
    			'tournament' => $tournamentName, 
   				'name' => '%'.$playerName.'%'
				];

        $queryBuilder = $this->createQueryBuilder('p');
        return $queryBuilder
			        		->where($queryBuilder->expr()
			            	->like('p.name', ':name'))
			            	->where('t.name = :tournament')
			            	->setParameter($parameters)
			            	->getQuery()->getOneOrNullResult();

    }
}
